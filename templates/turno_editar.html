{% extends "base.html" %}
{% block content %}

<div class="mb-3">
  <div class="text-zinc-400 text-[11px] tracking-widest mb-1">TURNO</div>
  <h2 class="text-lg font-semibold">Editar turno</h2>
</div>

{% if error %}
  <div class="mb-3 px-4 py-3 rounded-2xl border border-red-700 bg-red-900/20 text-red-200 text-sm">
    {{ error }}
  </div>
{% endif %}

<form method="post" action="/turnos/{{ appt.id }}/editar" class="space-y-3">
  <div class="rounded-3xl border border-zinc-800 bg-white/5 backdrop-blur-xl p-4 space-y-3">

    <div class="grid grid-cols-2 gap-2">
      <div>
        <label class="text-xs text-zinc-400">Fecha</label>
        <input name="fecha" type="date" value="{{ appt.date.strftime('%Y-%m-%d') }}" required
               class="w-full mt-1 px-3 py-3 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
      </div>

      <div>
        <label class="text-xs text-zinc-400">Hora</label>
        <input name="hora" type="time" value="{{ appt.start_time.strftime('%H:%M') }}" required
               class="w-full mt-1 px-3 py-3 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
      </div>
    </div>

    <div>
      <label class="text-xs text-zinc-400">Duraci칩n</label>
      <select name="duration_min" required
              class="w-full mt-1 px-3 py-3 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
        {% for m in [15,30,45,60,75,90,105,120,135,150,165,180,195,210,225,240] %}
          <option value="{{ m }}" {% if appt.duration_min == m %}selected{% endif %}>
            {{ "%02d"|format(m//60) }}:{{ "%02d"|format(m%60) }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div>
      <label class="text-xs text-zinc-400">Cliente</label>
      <select name="client_id" required
              class="w-full mt-1 px-3 py-3 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
        {% for c in clients %}
          <option value="{{ c.id }}" {% if c.id == appt.client_id %}selected{% endif %}>{{ c.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div>
      <label class="text-xs text-zinc-400">Trabajo</label>
      <select name="specialty_id" required
              class="w-full mt-1 px-3 py-3 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
        {% for sp in specialties %}
          <option value="{{ sp.id }}" {% if sp.id == appt.specialty_id %}selected{% endif %}>{{ sp.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="grid grid-cols-2 gap-2">
      <div>
        <label class="text-xs text-zinc-400">Staff</label>
        <select name="staff_id" required
                class="w-full mt-1 px-3 py-3 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
          {% for s in staff_list %}
            <option value="{{ s.id }}" {% if s.id == appt.staff_id %}selected{% endif %}>{{ s.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="text-xs text-zinc-400">Sal칩n</label>
        <select name="salon_id" required
                class="w-full mt-1 px-3 py-3 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
          {% for sa in salons %}
            <option value="{{ sa.id }}" {% if sa.id == appt.salon_id %}selected{% endif %}>{{ sa.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="flex items-center gap-3">
      <input id="deposit_paid" name="deposit_paid" type="checkbox" class="w-5 h-5" {% if appt.deposit_paid %}checked{% endif %}>
      <label for="deposit_paid" class="text-sm text-zinc-200 font-semibold">Dej칩 se침a</label>
      <input name="deposit_amount" type="number" value="{{ appt.deposit_amount or 0 }}" min="0"
             class="ml-auto w-32 px-3 py-2 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
    </div>

    <div>
      <label class="text-xs text-zinc-400">Estado</label>
      <select name="status"
              class="w-full mt-1 px-3 py-3 rounded-2xl bg-zinc-900/60 border border-zinc-700 text-white">
        <option value="CONFIRMADO" {% if appt.status=="CONFIRMADO" %}selected{% endif %}>Confirmado</option>
        <option value="CANCELADO" {% if appt.status=="CANCELADO" %}selected{% endif %}>Cancelado</option>
      </select>
    </div>

  </div>

  <button type="submit" class="w-full px-4 py-3 rounded-2xl font-semibold text-zinc-900"
          style="background: var(--gold);">
    Guardar cambios
  </button>
</form>

<form method="post" action="/turnos/{{ appt.id }}/eliminar" class="mt-3">
  <button type="submit" class="w-full px-4 py-3 rounded-2xl font-semibold border border-red-700 bg-red-900/20 text-red-200">
    Eliminar turno
  </button>
</form>

{% endblock %}
