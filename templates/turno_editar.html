{% extends "base.html" %}
{% block content %}

<div class="mb-4">
  <div class="text-zinc-400 text-[11px] tracking-widest mb-1">AGENDA</div>
  <div class="text-2xl font-semibold">Editar turno</div>
</div>

<form method="post" action="/turnos/{{ a.id }}/editar" class="card p-4 space-y-4">

  <div class="grid grid-cols-2 gap-2">
    <div>
      <div class="text-sm font-bold mb-2">Fecha</div>
      <input name="date_str" value="{{ a.date.strftime('%Y-%m-%d') }}" type="date"
             class="w-full px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">
    </div>
    <div>
      <div class="text-sm font-bold mb-2">Hora</div>
      <input name="time_str" value="{{ a.start_time.strftime('%H:%M') }}" type="time"
             class="w-full px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">
    </div>
  </div>

  <div>
    <div class="text-sm font-bold mb-2">Cliente</div>
    <select name="client_id" class="w-full px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">
      {% for c in clients %}
        <option value="{{ c.id }}" {% if c.id==a.client_id %}selected{% endif %}>{{ c.name }}{% if c.phone %} ({{ c.phone }}){% endif %}</option>
      {% endfor %}
    </select>
  </div>

  <div>
    <div class="text-sm font-bold mb-2">Servicio</div>
    <select name="specialty_id" class="w-full px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">
      <option value="0">—</option>
      {% for s in specialties %}
        <option value="{{ s.id }}" {% if a.specialty_id==s.id %}selected{% endif %}>{{ s.name }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="grid grid-cols-2 gap-2">
    <div>
      <div class="text-sm font-bold mb-2">Duración</div>
      <select name="duration_min" class="w-full px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">
        {% for m in range(15, 241, 15) %}
          <option value="{{ m }}" {% if a.duration_min==m %}selected{% endif %}>
            {{ "%02d:%02d"|format(m//60, m%60) }} hs
          </option>
        {% endfor %}
      </select>
    </div>

    <div>
      <div class="text-sm font-bold mb-2">Seña (mismo renglón)</div>
      <div class="flex items-center gap-2">
        <label class="flex items-center gap-2 font-bold text-sm">
          <input type="checkbox" name="deposit_paid" value="1" class="scale-125" {% if a.deposit_paid %}checked{% endif %}>
          Dejó
        </label>

        <input name="deposit_amount" type="number" value="{{ a.deposit_amount }}"
               placeholder="$"
               class="flex-1 px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">
      </div>
    </div>
  </div>

  <div class="grid grid-cols-2 gap-2">
    <div>
      <div class="text-sm font-bold mb-2">Staff</div>
      <select name="staff_id" class="w-full px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">
        <option value="0">—</option>
        {% for st in staff %}
          <option value="{{ st.id }}" {% if a.staff_id==st.id %}selected{% endif %}>{{ st.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div>
      <div class="text-sm font-bold mb-2">Salón</div>
      <select name="salon" class="w-full px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">
        <option value="1" {% if a.salon==1 %}selected{% endif %}>Salón 1</option>
        <option value="2" {% if a.salon==2 %}selected{% endif %}>Salón 2</option>
      </select>
    </div>
  </div>

  <div>
    <div class="text-sm font-bold mb-2">Notas del turno</div>
    <textarea name="notes" rows="4"
              class="w-full px-4 py-3 rounded-2xl bg-black/30 border border-zinc-800 text-white">{{ a.notes }}</textarea>
  </div>

  <button class="w-full py-3 rounded-2xl font-extrabold text-zinc-900" style="background: var(--gold);">
    Guardar cambios
  </button>
</form>

<form method="post" action="/turnos/{{ a.id }}/cancelar" class="mt-3">
  <button class="w-full py-3 rounded-2xl font-extrabold border border-red-700 text-red-200 bg-red-900/20">
    Cancelar turno
  </button>
</form>

{% endblock %}
